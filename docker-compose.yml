version: '3.8'

services:
  app:
    image: 'hames1616/image:latest'
    container_name: laravel_app
    restart: always
    depends_on:
      - mysql
    volumes:
      - '.:/var/www/html'
    environment:
      APP_NAME: Laravel
      APP_ENV: local
      APP_KEY: base64:7SS9uP1gbr4jojaThLYUcDPHKs32aHdREPNdJa5cQ+g=
      APP_DEBUG: true
      APP_TIMEZONE: UTC
      APP_URL: server_ip
      APP_LOCALE: en
      APP_FALLBACK_LOCALE: en
      APP_FAKER_LOCALE: en_US
      APP_MAINTENANCE_DRIVER: file
      PHP_CLI_SERVER_WORKERS: 4
      BCRYPT_ROUNDS: 12
      LOG_CHANNEL: stack
      LOG_STACK: single
      LOG_DEPRECATIONS_CHANNEL: null
      LOG_LEVEL: debug
      DB_CONNECTION: mysql
      DB_HOST: mysql  # Refers to MySQL container instead of IP
      DB_PORT: 3306
      DB_DATABASE: ai_blog_backend
      DB_USERNAME: username
      DB_PASSWORD: password
      SESSION_DRIVER: database
      SESSION_LIFETIME: 120
      SESSION_ENCRYPT: false
      SESSION_PATH: /
      SESSION_DOMAIN: null
      BROADCAST_CONNECTION: log
      FILESYSTEM_DISK: local
      QUEUE_CONNECTION: database
      CACHE_STORE: database
      MEMCACHED_HOST: 127.0.0.1
      VITE_APP_NAME: "${APP_NAME}"
    ports:
      - "8000:8000" # Change this if Laravel is running on a different port

  mysql:
    image: mysql:8.0
    container_name: mysql_container
    restart: always
    environment:
      MYSQL_ROOT_PASSWORD: rootpassword
      MYSQL_DATABASE: ai_blog_backend
      MYSQL_USER: username
      MYSQL_PASSWORD: password
    ports:
      - "3306:3306"
    volumes:
      - mysql-data:/var/lib/mysql

volumes:
  mysql-data:
